# ğŸ’° Ultra-Cheap Architecture: $5-10/Ğ¼ĞµÑÑÑ†
## Chess Telegram Mini App - Full Docker Setup

---

## ğŸ¯ Ğ¡Ñ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ Ğ¡Ñ‚Ğ¾Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸

### âŒ Managed Services (Ğ´Ğ¾Ñ€Ğ¾Ğ³Ğ¾):
```
Supabase Pro:      $25/Ğ¼ĞµÑ
NestJS VPS:        $20/Ğ¼ĞµÑ
Redis Cloud:       $10/Ğ¼ĞµÑ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Ğ˜Ğ¢ĞĞ“Ğ:             $55/Ğ¼ĞµÑ
```

### âœ… Docker Ğ½Ğ° VPS (Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾):
```
VPS (4GB RAM):     $10/Ğ¼ĞµÑ  (Hetzner, DigitalOcean, Contabo)
Domain:            $1/Ğ¼ĞµÑ   (Cloudflare)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Ğ˜Ğ¢ĞĞ“Ğ:             $11/Ğ¼ĞµÑ  âœ… (-$44/Ğ¼ĞµÑ = 80% ÑĞºĞ¾Ğ½Ğ¾Ğ¼Ğ¸Ñ!)
```

### ğŸ”¥ Docker Ğ½Ğ° VPS + Supabase Free (Ğ³Ğ¸Ğ±Ñ€Ğ¸Ğ´):
```
VPS (2GB RAM):     $5/Ğ¼ĞµÑ   (Hetzner CPX11)
Supabase Free:     $0/Ğ¼ĞµÑ   (500MB DB, 50K MAU, 2GB egress)
Domain:            $1/Ğ¼ĞµÑ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Ğ˜Ğ¢ĞĞ“Ğ:             $6/Ğ¼ĞµÑ   âœ… (-$49/Ğ¼ĞµÑ = 89% ÑĞºĞ¾Ğ½Ğ¾Ğ¼Ğ¸Ñ!)
```

---

## ğŸ—ï¸ ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

### Ğ’Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ 1: ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ Docker (ÑĞ°Ğ¼Ñ‹Ğ¹ Ğ´ĞµÑˆĞµĞ²Ñ‹Ğ¹)

```
         Internet
            â”‚
            â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  Nginx   â”‚ :80, :443 (SSL)
      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
           â”‚
    â”â”â”â”â”â”â”â”»â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
    â”ƒ   VPS ($5-10/Ğ¼ĞµÑ)              â”ƒ
    â”ƒ   Docker Compose               â”ƒ
    â”ƒ                                â”ƒ
    â”ƒ  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”ƒ
    â”ƒ  â”‚  Frontend  â”‚  â”‚ NestJS   â”‚ â”ƒ
    â”ƒ  â”‚  (Vite)    â”‚  â”‚ :3000    â”‚ â”ƒ
    â”ƒ  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â”ƒ
    â”ƒ                        â”‚       â”ƒ
    â”ƒ  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â” â”ƒ
    â”ƒ  â”‚PostgreSQLâ”‚â—„â”€â”€â”¤   Redis   â”‚ â”ƒ
    â”ƒ  â”‚  :5432   â”‚   â”‚   :6379   â”‚ â”ƒ
    â”ƒ  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”ƒ
    â”ƒ                                â”ƒ
    â”ƒ  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”ƒ
    â”ƒ  â”‚ Supabase Realtime       â”‚  â”ƒ
    â”ƒ  â”‚ (Self-hosted) :4000     â”‚  â”ƒ
    â”ƒ  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”ƒ
    â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›
```

**ĞšĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ñ‹:**
- `nginx` - Reverse proxy + SSL (Let's Encrypt)
- `postgres` - Ğ‘Ğ°Ğ·Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… (20GB volume)
- `redis` - ĞšĞµÑˆ Ğ´Ğ»Ñ Ğ´Ğ²Ğ¸Ğ¶ĞºĞ¾Ğ²
- `nestjs` - Backend API + Stockfish
- `realtime` - Supabase Realtime (self-hosted)
- `frontend` - React app (production build)

**Volumes:**
- `postgres_data` - Persistent Ğ‘Ğ”
- `redis_data` - Persistent ĞºĞµÑˆ
- `stockfish_cache` - ĞšĞµÑˆ Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¹

---

### Ğ’Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ 2: Ğ“Ğ¸Ğ±Ñ€Ğ¸Ğ´ (Docker + Supabase Free)

```
         Internet
            â”‚
      â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
      â”‚            â”‚
      â–¼            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   VPS    â”‚  â”‚  Supabase   â”‚
â”‚  Docker  â”‚  â”‚  Free Tier  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚              â”‚
  NestJS      PostgreSQL
  Redis        Realtime
               Auth
```

**ĞŸÑ€ĞµĞ¸Ğ¼ÑƒÑ‰ĞµÑÑ‚Ğ²Ğ°:**
- âœ… Supabase Free tier: 500MB Ğ‘Ğ” (Ğ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ¾Ñ‡Ğ½Ğ¾ Ğ´Ğ»Ñ ÑÑ‚Ğ°Ñ€Ñ‚Ğ°)
- âœ… Real-time WebSocket Ğ±ĞµÑĞ¿Ğ»Ğ°Ñ‚Ğ½Ğ¾
- âœ… ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ backup (Supabase)
- âœ… VPS Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ´Ğ»Ñ Ğ´Ğ²Ğ¸Ğ¶ĞºĞ¾Ğ² ($5/Ğ¼ĞµÑ)

---

## ğŸ“¦ Docker Compose Configuration

### Production-Ready Stack

**Ğ¤Ğ°Ğ¹Ğ»:** `docker-compose.production.yml`

Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¼ Ğ¿Ğ¾Ğ»Ğ½Ñ‹Ğ¹ production-ready docker-compose Ñ:
- PostgreSQL 15
- Redis 7
- NestJS backend
- Nginx reverse proxy
- Supabase Realtime (self-hosted)
- ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ SSL (Let's Encrypt)
- Health checks
- Restart policies
- Resource limits
- Logging

---

## ğŸ’¾ Ğ¢Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğº VPS

### ĞœĞ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ (Ğ´Ğ»Ñ ÑÑ‚Ğ°Ñ€Ñ‚Ğ°):
```
CPU:     2 vCPU
RAM:     2GB
Disk:    20GB SSD
Traffic: 1TB/Ğ¼ĞµÑ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Ğ¦ĞµĞ½Ğ°:    $5/Ğ¼ĞµÑ (Hetzner CPX11)
```

### Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµĞ¼Ñ‹Ğµ (Ğ´Ğ»Ñ 10K Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹):
```
CPU:     4 vCPU
RAM:     4GB
Disk:    40GB SSD
Traffic: 2TB/Ğ¼ĞµÑ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Ğ¦ĞµĞ½Ğ°:    $10/Ğ¼ĞµÑ (Hetzner CPX21, DigitalOcean)
```

### ĞŸÑ€Ğ¾Ğ²Ğ°Ğ¹Ğ´ĞµÑ€Ñ‹ (Ñ†ĞµĞ½Ğ° Ğ·Ğ° 4GB RAM):

| ĞŸÑ€Ğ¾Ğ²Ğ°Ğ¹Ğ´ĞµÑ€ | Ğ¦ĞµĞ½Ğ°/Ğ¼ĞµÑ | CPU | RAM | Disk | Traffic |
|-----------|----------|-----|-----|------|---------|
| **Hetzner** | â‚¬4.51 (~$5) | 2 vCPU | 4GB | 40GB | 20TB âœ… |
| **Contabo** | â‚¬6.99 (~$7) | 4 vCPU | 8GB | 100GB | Unl. âœ… |
| DigitalOcean | $24 | 2 vCPU | 4GB | 80GB | 4TB |
| Linode | $24 | 2 vCPU | 4GB | 80GB | 4TB |
| AWS Lightsail | $20 | 2 vCPU | 4GB | 80GB | 4TB |

**Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ°Ñ†Ğ¸Ñ: Hetzner CPX21 (â‚¬4.51/Ğ¼ĞµÑ)** ğŸ†

---

## ğŸš€ ĞœĞ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

### 10K Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ñ… Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹:
```
VPS 4GB:           $10/Ğ¼ĞµÑ
Supabase Free:     $0/Ğ¼ĞµÑ (Ğ¸Ğ»Ğ¸ Pro $25 ĞµÑĞ»Ğ¸ Ğ½ÑƒĞ¶Ğ½Ğ¾ >500MB)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Ğ˜Ğ¢ĞĞ“Ğ:             $10-35/Ğ¼ĞµÑ
```

### 100K Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ñ… Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹:
```
VPS 8GB x2:        $20/Ğ¼ĞµÑ (load balancing)
Supabase Pro:      $25/Ğ¼ĞµÑ
CDN (Cloudflare):  $0/Ğ¼ĞµÑ (free tier)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Ğ˜Ğ¢ĞĞ“Ğ:             $45/Ğ¼ĞµÑ
```

**Ğ­ĞºĞ¾Ğ½Ğ¾Ğ¼Ğ¸Ñ vs Managed:** $200+/Ğ¼ĞµÑ

---

## ğŸ“Š Ğ¡Ñ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ Ğ’Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚Ğ¾Ğ²

| ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€ | Full Docker | Hybrid (Docker+Supabase Free) | Managed |
|----------|-------------|------------------------------|---------|
| **Ğ¡Ñ‚Ğ¾Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ** | $10/Ğ¼ĞµÑ | $6/Ğ¼ĞµÑ âœ… | $55/Ğ¼ĞµÑ |
| **Setup ÑĞ»Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒ** | Ğ’Ñ‹ÑĞ¾ĞºĞ°Ñ | Ğ¡Ñ€ĞµĞ´Ğ½ÑÑ | ĞĞ¸Ğ·ĞºĞ°Ñ |
| **Maintenance** | Ğ ÑƒÑ‡Ğ½Ğ¾Ğ¹ | Ğ§Ğ°ÑÑ‚Ğ¸Ñ‡Ğ½Ğ¾ Ğ°Ğ²Ñ‚Ğ¾ | ĞĞ²Ñ‚Ğ¾ |
| **Backup** | Ğ ÑƒÑ‡Ğ½Ğ¾Ğ¹ | ĞĞ²Ñ‚Ğ¾ (Supabase) | ĞĞ²Ñ‚Ğ¾ |
| **Scaling** | Ğ ÑƒÑ‡Ğ½Ğ¾Ğ¹ | Ğ¡Ñ€ĞµĞ´Ğ½Ğ¸Ğ¹ | ĞĞ²Ñ‚Ğ¾ |
| **Real-time** | Self-hosted | Managed âœ… | Managed âœ… |
| **Ğ‘Ğ” Ñ€Ğ°Ğ·Ğ¼ĞµÑ€** | Unlimited | 500MB â†’ $25 (8GB) | 8GB+ |

**Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ°Ñ†Ğ¸Ñ Ğ´Ğ»Ñ ÑÑ‚Ğ°Ñ€Ñ‚Ğ°: Hybrid (Docker + Supabase Free)** âœ…

---

## ğŸ¯ ĞŸĞ»Ğ°Ğ½ Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸

Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¼ ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğµ Ñ„Ğ°Ğ¹Ğ»Ñ‹:

1. `docker-compose.production.yml` - Full production stack
2. `docker-compose.hybrid.yml` - Hybrid Ñ Supabase Free
3. `backend/Dockerfile` - Production NestJS image
4. `frontend/Dockerfile` - Production React image
5. `nginx/nginx.conf` - Reverse proxy config
6. `scripts/deploy.sh` - ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ deploy
7. `scripts/backup.sh` - Backup PostgreSQL
8. `.env.production.example` - Production env vars

ĞŸÑ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶Ğ¸Ñ‚ÑŒ? ğŸš€
